---
title: 'SGD CPTAC data loop number of factors'
author: "Alex"
date: "2024-07-18"
output: html_document
---


```{r}
library(here)
library(sgdGMF)
library(dplyr)
library(RSpectra)
library(scater)
library(BiocParallel)
library(BiocSingular)
library(DelayedArray)

devtools::load_all(here("omicsGMF"))

```



# Original data

```{r}
sce <- readRDS(file = here("Data","CPTAC_nolab1","CPTAC_sce.RDS"))

```


```{r}
for(i in c(1:10)){
  set.seed(100)
  
  begin_time <- Sys.time()
  family <- gaussian()
  sgd <-  calculateGMF(sce, family = family, exprs_values = "logintensities", 
                         control.alg = list(tol = 0.001, maxiter = 10000),
                         ncomponents = i)
  end_time <- Sys.time()
  time_diff <- end_time - begin_time
  print(time_diff)
  saveRDS(object = sgd, file = here("Analyses","CPTAC_nolab1","Output",
                                    paste0("sgd_sce_", i, "LF.RDS")))
}
```







